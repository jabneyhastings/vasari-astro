---
// filepath: src/pages/[page].astro
import Layout from '../layouts/Layout.astro';
import HeroImage from '../components/HeroImage.astro';
import { getEntry, getCollection } from 'astro:content';

export async function getStaticPaths() {
  // List all JSON files in the 'pages' collection except 'home'
  const entries = await getCollection('pages');
  return entries
    .filter(entry => entry.id !== 'home') // Exclude home if needed
    .map(entry => ({
      params: { page: entry.id },
    }));
}

const { page } = Astro.params;
const entry = await getEntry('pages', page);

if (!entry) {
  throw new Error(`Page not found: ${page}`);
}

const { title, description, heroImage, content } = entry.data;
---

<Layout title={title} description={description}>
    {heroImage && (
        <HeroImage src={heroImage} alt={title} />
    )}

    <main class="page-content">
        <h1>{title}</h1>
        <div set:html={content} />
    </main>
</Layout>